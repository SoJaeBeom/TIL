# 가상 돔

## DOM 이란

- Document Object Model (문서 객체 모델)의 약자이다.
- 문서 객체란 Web Browser 안에서 HTML 문서에 JavaScript가 접근할 수 있도록 HTML 태그 들을 객체로 만든 것이다.
- 프로그래밍 언어가 DOM 구조에 접근할 수 있는 방법을 제공하여 문서 구조, 스타일, 내용 등을 변경할 수 있게 돕는 역할을 한다.

## 기존 렌더링 방식

1. 브라우저는 서버가 보내준 HTML 파일 을 해석(Parsing)하여 DOM 트리 를 만든다.
2. 브라우저는 서버가 보내준 CSS 파일 을 해석(Parsing)하여 CSSOM 트리 도 만든다.
3. DOM 트리 + CSSOM 트리 를 결합해 렌더트리 를 만든다.
4. 렌더트리로 각 노드의 위치와 크기를 계산한 레이아웃 을 만든다. 뷰포트(Viewport) 내에서 각 노드들의 위치와 크기를 계산한다
5. Layout 계산이 완료되면 이제 요소들을 실제 화면을 그리는 페인트(Paint) 를 한다.

### 문제점

- DOM은 새로운 요청이나 변경사항이 있을 때마다 매번 리렌더링을 한다.
- 하지만 매번 새롭게 구성하기 때문에, 렌더할 양이 많으면 속도가 느려지게 된다.

## 가상 돔

- DOM의 구조를 흉내낸 JavaScript  객체이다. (트리구조)
- in-memory에 존재해서 실제 렌더 되지 않는다.

### 리액트가 가상돔을 반영하는 절차

1. 뭔가 바뀌면 UI 를 가상돔에 리렌더링 한다.
2. 가상돔끼리 비교하고(diffing 알고리즘)
3. 바뀐 부분만 실제 DOM에 적용한다. (레이아웃계산은 한번만))
