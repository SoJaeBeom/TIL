# ALU와 제어장치

## ALU

- 레지스터를 통해 피연산자를 받아들이고 제어장치로부터 수행할 연산을 알려주는 제어 신호를 받아들인다.
- 연산을 수행한 결과는 특정 숫자나 문자가 될 수도 있고 메모리 주소가 될 수도 있다.
  - 결과값은 바로 메모리에 저장되지 않고 일시적으로 레지스터에 저장된다.
  - CPU가 메모리에 접근하는 속도는 레지스터에 접근하는 속도보다 훨씬 느리다.
- 연산 결과가 연산 결과를 담을 레지스터보다 큰 상황을 오버플로우라고 한다.
- 연산 결과에 대한 추가적인 상태 정보를 플래그라고 한다.
- 플래그들은 플래그 레지스터라는 레지스터에 저장된다.
- 덧셈을 위한 가산기, 뺄셈을 위한 보수기, 시프트 연산을 수행해주는 시프터, 오버플로우를 대비한 오버플로우 검출기가 있다.

## 제어장치

- 제어장치는 제어신호를 내보내고 명령어를 해석하는 부품이다.
- 제어 신호는 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호다.

### 제어장치가 받아들이는 정보

- 클럭 신호를 받아들인다.
  - 클럭이란 컴퓨터의 모든 부품을 일사불란하게 움직일 수있게 하는 시간 단위다.
- 해석해야 할 명령어를 받아들인다.
  - CPU가 해석해야할 명령어는 명령어 레지스터라는 특별한 레지스터에 저장된다.
- 플래그 레지스터 속 플래그 값을 받아들인다.
- 시스템 버스, 그중에서 제어 버스로 전달된 제어 신호를 받아들인다.
-

### 제어장치가 내보내는 정보

- CPU 외부에 전달하는 제어신호와 CPU 내부에 전달하는 제어 신호가 있다.
- 제어신호에는 메모리에 전달하는 제어신호와 입출력 장치에 전달하는 제어신호가 있다.

# 레지스터

- 프로그램 속 명령어와 데이터는 실행 전후로 반드시 레지스터에 저장된다.
- 레지스터에 저장된 값만 잘 관찰해도 프로그램의 실행 흐름을 파악할 수 있다.

## 반드시 알아야 할 레지스터

- 레지스터는 CPU내부의 작은 임시 저장 장치다.
- 프로그램 카운터는 메모리에서 가져올 명령어의 주소, 즉 메모리에서 읽어 들일 명령어의 주소를 저장한다.
- 명령어 레지스터는 해석할 명령어, 즉 방금 메모리에서 읽어 들인 명령어를 저장하는 레지스터이다.
- 메모리 주소 레지스터는 메모리의 주소를 저장하는 레지스터이다.
- 메모리 버퍼 레지스터는 메모리와 주고 받을 값(데이터와 명령어)을 저장하는 레지스터이다.
- CPU가 메모리 속 프로그램을 순차적으로 읽어 들이고 실행해 나갈 수 있는 이유는 CPU 속 프로그램 카운터가 꾸준히 증가하기 때문이다.
- 범용 레지스터는 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터이다.
- 범용 레지스터는 데이터와 주소를 모두 저장할 수 있다.
- 플래그 레지스터는 연산 결과 또는 CPU상태에 대한 부가적인 정보를 저장하는 레지스터이다.
- 스택 포인터는 스택 주소 지정 방식이라는 주소 지정 방식에 사용된다.
- 프로그램 타운터와 베이스 레지스터는 변위 주소 지정 방식이라는 주소지정 방식에 사용된다.
- 스택 주소 지정 방식은 스택과 스택 포인터를 이용한 주소 지정 방식이다.
- 스택 포인터란 스택의 꼭대기를 가리키는 레지스터이다.
  - 스택은 메모리 안에 있다.
  - 메모리 안에 스택처럼 사용할 영여이 정해져있는 것을 스택 영역이라고 한다.
- 변위 주소 지정 방식은 오퍼랜드 필드의 값(변위)과 특정 레지스터의 값을 더하여 유효 주소를 얻어내는 주소 지정 방식이다.
- 변위 주소 지정 방식은 오퍼랜드 필드의 주소와 어떤 레지스터를 더하는지에 따라 상대 주소 지정방식, 베이스 레지스터 주소 지정 방식으로 나눠진다.
- 상대 주소 지정 방식은 오퍼랜드와 프로그램 카운터의 값을 더하여 유효 주소를 얻는 방식이다.
- 베이스 레지스터 주소 지정 방식은 오퍼랜드와 베이스 레지스터의 값을 더하여 유효 주소를 얻는 방식이다.
  - 베이스 레지스터는 기준 주소, 오퍼랜드는 기준 주소로부터 떨어진 거리로서의 역할을 한다.

# 명령어 사이클과 인터럽트

## 명령어 사이클

- 프로그램 속 각각의 명령어들은 일정한 주기가 반복되며 실행되는데 이 주기를 명령어 사이클이라고 한다.
- 메모리에 있는 명령어를 CPU로 가지고 오는 단계를 인출 사이클이라고 한다.
  - 인출이란 CPU가 메모리 안에 있는 어떤 프로그램을 실행하기 위해 메모리에 저장된 값을 CPU내부로 가져오는 작업이다.
- CPU로 가져온 명령어를 실행하는 단계를 실행 사이클이라고 한다.
- 명령어를 실행하기 위해서는 메모리 접근을 한번더 해야하는데 이 단계를 간접 사이클이라고 한다.

## 인터럽트

- CPU가 수행중인 작업은 방해를 받아 잠시 중단될 수 있는데 이렇게 CPU의 작업을 방해하는 신호를 인터럽트라고 한다.
- 동기 인터럽트는 CPU에 의해 발생하는 인터럽트이다.
  - CPU가 명령어들을 수행하다가 예상치 못한 상황에 마주쳤을때 발생하는 인터럽트다.
  - 동기 인터럽트는 예외라고 부른다.
- 비동기 인터럽트는 주로 입출력장치에 의해 발생하는 인터럽트다.
  - 하드웨어 인터럽트라고 한다.
- 하드웨어 인터럽트는 알림과 같은 인터럽트이다.
  - CPU는 입출력 작업 도중에도 효율적으로 명령어를 처리하기 위해 이런 알림과 같은 하드웨어 인터럽트를 사용한다.
- 인터럽트는 CPU의 정상적인 실행 흐름을 끊는 것이기에 다른 누군가가 인터럽트하기 전에는 CPU에 물어봐야한다. 이를 인터럽트 요청 신호라고 한다.
- 인터럽트 플래그는 하드웨어 인터럽트를 받아들일지, 무시할지를 결정하는 플래그이다.
  - CPU가 인터럽트 요청을 수용하기 위해서는 플래그 레지스터의 인터럽트 플래그가 활성화되어 있어야 한다.
- 인터럽트 서비스 루틴은 인터럽트를 처리하기 위한 프로그램이다.
  - 인터럽트 핸들러라고도 부른다.
  - 어떤 인터럽트가 발생했을 때 해당 인터럽트를 어떻게 처리하고 작동해야 할지에 대한 정보로 이루어진 프로그램이다.
- 인터럽트 벡터는 인터럽트 서비스 루틴을 식별하기 위한 정보이다.
- 인터럽트 벡터를 알면 인터럽트 서비스 루틴의 시작 주소를 알수 있기 때문에 CPU는 인터럽트 벡터를 통해 특정 인터럽트 서비스 루틴을 처음부터 실행할 수 있다.
