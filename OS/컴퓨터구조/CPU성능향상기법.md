# CPU 성능 향상 기법

## 클럭

- 클럭속도는 헤르츠(Hz) 단위로 측정한다.
- 클럭속도가 높은 CPU는 빠르게 동작한다.

> 오버클럭킹
>
> - 최대 클럭 속도를 강제로 더 끌어올리는 기법이다.

## 코어와 멀티코어

- 클럭 속도를 높이는 방법은 CPU의 코어와 스레드 수를 늘리는 방법이 있다.
- CPU는 단순히 명령어를 실행하는 부품에서 명령어를 실행하는 부품을 여러 개 포함하는 부품이다.
- 코어를 여러개 포함하고 있는 CPU를 멀티코어 CPU, 멀티코어 프로세서라고 부른다.

## 스레드와 멀티스레드

- 스레드는 실행 흐름의 단위이다.
- 스레드에는 CPU에서 사용되는 하드웨어적 스레드가 있고 프로그램에서 사용되는 소프트웨어적 스레드가 있다.

### 하드웨어적 스레드

- 하나의 코어가 동시에 처리하는 명령어 단위를 의미한다.
- 여러 스레드를 지원하는 CPU는 하나의 코어로도 여러개의 명령어를 동시에 실행할 수 있다.
- 하나의 코어로 여러 명령어를 동시에 처리하는 CPU를 멀티스레드 프로세서, 멀티스레드 CPU라고 한다.

### 소프트웨어적 스레드

- 하나의 프로그램에서 독립적으로 실행되는 단위이다.
- 하나의 프로그램은 실행되는 과정에서 한 부분만 실행될수도 있지만 프로그램의 여러 부분이 동시에 실행될 수도 있다.

### 멀티스레드 프로세서

- 하나의 코어로 여러 명령어를 동시에 처리하는 CPU다.
- 하나의 코어로 여려 명령어를 동시에 처리하도록 만들려면 프로그램 카운터, 스택 포인터, 메모리 버퍼레지스터, 메모리 주소 레지스터와 같이 하나의 명령어를 처리하기 위해 필요한 레지스터를 여러개 가지고 있어야한다.
- 논리 프로세서라고 부른다.

## 명령어 파이프라인

- 명령어 처리 과정을 클럭 단위로 나누면 명령어 인출, 명령어 해석, 명령어 실행, 결과 저장 단계로 나눌 수 있다.
- 각 단계가 겹치지만 않는다면 CPU는 각 단계를 동시에 실행할 수 있다.
- 명령어들을 명령어 파이프라인에 넣고 동시에 처리하는 기법을 명령어 파이프라이닝이라고 한다.
- 파이프라이닝이 높은 성능을 가져오기는 하지만 특정 상황에서는 성능 향상에 실패하는 경우도 있는데 파이프라인 위험이라고 한다.
- 파이프라인 위험에는 데이터 위험, 제어 위험, 구조적 위험이 있다.

### 데이터 위험

- 명령어 간 데이터 의존성에 의해 발생한다.
- 모든 명령어를 동시에 처리할 수는 없다.
- 어떤 명령어는 이전 명령어를 끝까지 실행해야만 비로소 실행할 수 있는 경우도 있다.
- 데이터 의존적인 두 명령어를 무작정 동시에 실행하려고 하면 파이프라인이 제대로 작동하지 않는 것을 데이터 위험이라고 한다.

### 제어 위험

- 분기등으로 인한 프로그램 카운터의 갑작스러운 변화에 의해 발생한다.
- 프로그램 카운터는 현재 실행중인 명령어의 다음주소로 갱신된다.

### 구조적 위험

- 명령어들을 겹쳐 실행하는 과정에서 서로 다른 명령어가 동시에 ALU, 레지스터 등과 같은 CPU 부품을 사용하려고 할 때 발생한다.
- 자원 위험이라고 부른다.

## 슈퍼스칼라

- CPU 내부에 여러개의 명령어 파이프라인을 포함한 구조를 슈퍼스칼라라고 한다.
- 슈퍼스칼라 구조로 명령어 처리가 가능한 CPU를 슈퍼스칼라 프로세서 또는 슈퍼스칼라 CPU라고 한다.
- 슈퍼스칼라 프로세서는 매 클럭 주기마다 동시에 여러 명령어를 인출할 수도 실행할 수도 있어야 한다.

## 비순차적 명령어 처리

- 파이프라인의 중단을 방지하기 위해 명령어를 순차적으로 처리하지 않는 명령어 병렬 처리 기법이다.
